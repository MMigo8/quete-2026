<script>
document.addEventListener("DOMContentLoaded", function() {
  // Sélectionne toutes les cases
  const checkboxes = document.querySelectorAll('.task-checkbox');
  const progressBar = document.getElementById('progress-bar');
  const progressText = document.getElementById('progress-text');

  // Met à jour la barre de progression
  function updateProgress() {
    if (checkboxes.length === 0) return;
    let checked = 0;
    checkboxes.forEach(cb => { if(cb.checked) checked++; });
    const percent = Math.round((checked / checkboxes.length) * 100);
    progressBar.style.width = percent + '%';
    progressText.textContent = percent + '% accompli';
  }

  // Sauvegarde automatique
  function saveProgress() {
    checkboxes.forEach((cb, index) => {
      localStorage.setItem('checkbox-' + index, cb.checked);
    });
  }

  // Charge la sauvegarde
  function loadProgress() {
    checkboxes.forEach((cb, index) => {
      const saved = localStorage.getItem('checkbox-' + index);
      cb.checked = saved === 'true';
    });
    updateProgress();
  }

  // Écoute les changements
  checkboxes.forEach(cb => {
    cb.addEventListener('change', () => {
      updateProgress();
      saveProgress();
    });
  });

  // Initialisation
  loadProgress();
});
</script>
